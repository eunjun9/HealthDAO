<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<title></title>
<!-- ë©”íƒ€íƒœê·¸, ìŠ¤íƒ€ì¼ -->
<th:block th:replace="common/head.html"></th:block>
<!--// ë©”íƒ€íƒœê·¸, ìŠ¤íƒ€ì¼ -->
<body>

	<div id="wrap" class="main">
		<!-- HEADER + GNB -->
		<th:block th:replace="common/header.html"></th:block>
		<!--// HEADER + GNB -->
	
		<!-- container -->		
		<div id="container" class="pdt0">
			<div class="site_location">
				<span><a href="/">HOME</a></span>
				<span><a href="/">ë§ˆì´í˜ì´ì§€</a></span>
				<em>ë©”ì¸ ë¡¤ë§ ê´€ë¦¬</em>
			</div>
			<div class="mypage">
				<div class="myWish myCon">
					<div class="contents">
						<th:block th:replace="common/mypageGnb.html"></th:block>
						<!-- myPageCon -->
						<div class="myPageCon">
							<p class="tit mgb40">
								ë§¤ì¸ ë¡¤ë§ ê´€ë¦¬
							</p>
							<div class="pdtWishBar mgb40">
								<span class="inp_check allChk">
									<input type="checkbox" name="inp_check1" id="inp_check1">
									<label for="inp_check1">ì „ì²´ì„ íƒ</label>
								</span>
								<div class="btn_wrap">
									<a href="javascript:void(0)" onclick="showLayer('enrollMain');" class="basketBtn btn btnSizeS btnColorW btnTypeB"><span>ë“±ë¡í•˜ê¸°</span></a>
									<a href="javascript:void(0)" onclick="showLayer('mainDel');" class="wishBtn btn btnSizeS btnColorW btnTypeB"><span>ì‚­ì œí•˜ê¸°</span></a>
								</div>
							</div>
							<div class="tblType1">
								<table summary="ë§¤ì¸ ë¡¤ë§ ê´€ë¦¬ í…Œì´ë¸”">
									<caption>ë§¤ì¸ ë¡¤ë§ ê´€ë¦¬ í…Œì´ë¸”</caption>
									<colgroup>
										<col width="6%">
										<col width="8%">
										<col width="*">
										<col width="12%">
										<col width="30%">
										<col width="6%">
										<col width="8%">
									</colgroup>
									<thead>
										<tr>
											<th>ì„ íƒ</th>
											<th>NO</th>
											<th>ë°°ë„ˆëª…</th>
											<th>ì´ë¯¸ì§€</th>
											<th>URL</th>
											<th>ìˆœìœ„</th>
											<th>ë…¸ì¶œìƒíƒœ</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="banner : ${bannerList}">
											<td>
												<span class="inp_check">
													<input type="checkbox" name="inp_check1" th:id="@{inp_check1_}+${banner.main_no}" th:value="${banner.main_no}">
													<label th:for="@{inp_check1_}+${banner.main_no}"></label>
												</span>
											</td>
											<td th:text="${banner.main_no}"></td>
											<td class="tdName"><a href="javascript:void(0);" onclick="showLayer('enrollMain')"><span th:text="${banner.main_name}"></span></a></td>
											<td class="tdImg"><img th:src="${banner.file_path}+${banner.change_file}" /></td>
											<td th:text="${banner.main_url}"></td>
											<td th:text="${banner.main_rank}"></td>
											<td th:text="${banner.main_status}"></td>
										</tr>
									</tbody>
								</table>
							</div>
							<div class="paging mgt40">
								<a href="#" class="first"><span class="hide">ì²«í˜ì´ì§€</span></a>
								<a href="#" class="prev"><span class="hide">ì´ì „í˜ì´ì§€</span></a>
								<a href="#">1</a>
								<a href="#" class="active">2</a>
								<a href="#">3</a>
								<a href="#">4</a>
								<a href="#">5</a>
								<a href="#" class="next"><span class="hide">ë‹¤ìŒí˜ì´ì§€</span></a>
								<a href="#" class="last"><span class="hide">ë§ˆì§€ë§‰í˜ì´ì§€</span></a>
							</div>
						</div>
						<!-- //myPageCon -->
					</div>
				</div>
			</div>
		</div>
		<!-- //container -->
		
		<!-- ìŠ¤í¬ë¦½íŠ¸ -->
		<th:block th:replace="common/script.html"></th:block>
		<!--// ìŠ¤í¬ë¦½íŠ¸ -->
		<!-- FOOTER -->
		<th:block th:replace="common/footer.html"></th:block>
		<!--// FOOTER -->
	</div>
	
	<!-- í€µë©”ë‰´ + í†¡í†¡ -->
	<th:block th:replace="common/quickNtalk.html"></th:block>
	<!--// í€µë©”ë‰´ + í†¡í†¡ -->	
	<!-- í•´ë‹¹ í˜ì´ì§€ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ìŠ¤íƒ€ì¼, ìŠ¤í¬ë¦½íŠ¸ -->
	<script type="text/javascript">
		$('#quick .quickArea').css({'position':'absolute', 'top':290});

	    function submit(){
	       	document.enroll.submit();
	    }
	</script>
	<!--// í•´ë‹¹ í˜ì´ì§€ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ìŠ¤íƒ€ì¼, ìŠ¤í¬ë¦½íŠ¸ -->

	<!-- ë©”ì¸ë¡¤ë§ ë“±ë¡ -->
	<div id="enrollMain" class="lyPopArea">
	    <div class="lyPop">
	        <div class="lyWrap">
	            <button type="button" class="lyClose" onclick="layerPopClose();"><span class="hide">CLOSED</span></button>
	            <div class="lyTit">ë©”ì¸ ë¡¤ë§ ë“±ë¡</div>
	            <form action="uploadBanner" name="enroll" method="post" enctype="multipart/form-data">
		            <div class="lyBody">			
						<ul class="inputArea">
							<li>
								<dl>
									<dt>ë°°ë„ˆëª…</dt>
									<dd>
										<div class="inp_wrap">
											<div class="inp_text sizeS">
												<input type="text" name="main_name" id="name" placeholder="ë©”ì¸ ë¡¤ë§ ë°°ë„ˆ ë‡½ë‡½ğŸ„ğŸ„">
												<button class="btn_clear"><span>clear</span></button>
											</div>
										</div>
									</dd>
								</dl>
								<dl class="mgt20">
									<dt>URL</dt>
									<dd>
										<div class="inp_wrap">
											<div class="inp_text sizeS">
												<input type="text" name="main_url" id="url" placeholder="/event?no=1">
												<button class="btn_clear"><span>clear</span></button>
											</div>
										</div>
									</dd>
								</dl>
								<dl class="mgt15">
									<dt>ì‚¬ì§„ ì¶”ê°€</dt>
									<dd>
										<ul class="fileUploadArea">
											<li><label for="imgUpload"><span class="hide">ì—…ë¡œë“œ</span></label><input type="file" class="hide" name="imgUpload" id="imgUpload" multiple accept="image/*"></li>
										</ul>
										<p class="mgt5 fs14">íŒŒì¼ì²¨ë¶€ (1ê°œ) <span class="fc88">5MBë¯¸ë§Œ jpg,gif,png íŒŒì¼ ê°€ëŠ¥</span></p>
									</dd>
								</dl>
							</li>
							<li>
								<dl class="mgt20">
									<dt>ìˆœìœ„</dt>
									<dd>
										<div class="inp_wrap">
											<div class="inp_text sizeS">
												<input type="text" name="main_rank" id="rank" placeholder="1">
												<button class="btn_clear"><span>clear</span></button>
											</div>
										</div>
									</dd>
								</dl>
								<dl class="mgt20">
									<dt>ë…¸ì¶œìƒíƒœ</dt>
									<dd class="mgt7">
										<div class="inp_wrap error">
											<span class="inp_check">
												<input type="radio" name="main_status" id="pdtQna_radio3_1" value="Y" checked>
												<label for="pdtQna_radio3_1">ë…¸ì¶œ</label>
											</span>
											<span class="inp_check mgl40">
												<input type="radio" name="main_status" id="pdtQna_radio3_2">
												<label for="pdtQna_radio3_2" class="fc88">ë¹„ë…¸ì¶œ</label>
											</span>
										</div>
										<p class="fs13 fc88 mgt10">* ë…¸ì¶œë¡œ ë“±ë¡ì‹œ ë©”ì¸í™”ë©´ì— ë“±ë¡ë©ë‹ˆë‹¤.</p>
									</dd>
								</dl>
							</li>
						</ul>
						<div class="btn_wrap mgt30">
							<a href="javascript:void(0);" class="btn btnSizeL btnArr btnColorW btnTypeR" style="width:200px;" onclick="layerPopClose();"><span>ì·¨ì†Œ</span></a>
							<a href="javascript:void(0);" class="btn btnSizeL btnArr btnColorB btnTypeR" style="width:200px;" onclick="return submit();"><span>ë“±ë¡</span></a>
						</div>
				     </div>
				</form>
	        </div>
	    </div>
	</div>
	<!-- ë©”ì¸ë¡¤ë§ ìˆ˜ì • -->
	<div id="enrollMain" class="lyPopArea">
	    <div class="lyPop">
	        <div class="lyWrap">
	            <button type="button" class="lyClose" onclick="layerPopClose();"><span class="hide">CLOSED</span></button>
	            <div class="lyTit">ë©”ì¸ ë¡¤ë§ ìˆ˜ì •</div>
	            <div class="lyBody">			
					<ul class="inputArea">
						<li>
							<dl>
								<dt>ë°°ë„ˆëª…</dt>
								<dd>
									<div class="inp_wrap">
										<div class="inp_text sizeS">
											<input type="text" name="name" id="name" value="ë©”ì¸ ë¡¤ë§ ë°°ë„ˆ ë‡½ë‡½ğŸ„ğŸ„">
											<button class="btn_clear"><span>clear</span></button>
										</div>
									</div>
								</dd>
							</dl>
							<dl class="mgt20">
								<dt>URL</dt>
								<dd>
									<div class="inp_wrap">
										<div class="inp_text sizeS">
											<input type="text" name="url" id="url" value="/event?no=1">
											<button class="btn_clear"><span>clear</span></button>
										</div>
									</div>
								</dd>
							</dl>
							<dl class="mgt15">
								<dt>ì‚¬ì§„ ì¶”ê°€</dt>
								<dd>
									<ul class="fileUploadArea">
										<li><label for="imgUpload"><span class="hide">ì—…ë¡œë“œ</span></label><input type="file" class="hide" name="imgUpload" id="imgUpload"></li>
										<li class="imgCutting">
											<div class="imgBox">
												<img src="./resources/web/images/temp/main01.jpg" alt="">
											</div>
											<a href="javascript:void(0)" class="closeLink"><span class="hide">close</span></a>
										</li>
									</ul>
									<p class="mgt5 fs14">íŒŒì¼ì²¨ë¶€ (1ê°œ) <span class="fc88">5MBë¯¸ë§Œ jpg,gif,png íŒŒì¼ ê°€ëŠ¥</span></p>
								</dd>
							</dl>
						</li>
						<li>
							<dl class="mgt20">
								<dt>ìˆœìœ„</dt>
								<dd>
									<div class="inp_wrap">
										<div class="inp_text sizeS">
											<input type="text" name="rank" id="rank" value="1">
											<button class="btn_clear"><span>clear</span></button>
										</div>
									</div>
								</dd>
							</dl>
							<dl class="mgt20">
								<dt>ë…¸ì¶œìƒíƒœ</dt>
								<dd class="mgt7">
									<div class="inp_wrap error">
										<span class="inp_check">
											<input type="radio" name="pdtQna_radio3" id="pdtQna_radio3_1" checked>
											<label for="pdtQna_radio3_1">ë…¸ì¶œ</label>
										</span>
										<span class="inp_check mgl40">
											<input type="radio" name="pdtQna_radio3" id="pdtQna_radio3_2">
											<label for="pdtQna_radio3_2" class="fc88">ë¹„ë…¸ì¶œ</label>
										</span>
									</div>
									<p class="fs13 fc88 mgt10">* ë…¸ì¶œë¡œ ë“±ë¡ì‹œ ë©”ì¸í™”ë©´ì— ë“±ë¡ë©ë‹ˆë‹¤.</p>
								</dd>
							</dl>
						</li>
					</ul>
					<div class="btn_wrap mgt30">
						<a href="#" class="btn btnSizeL btnArr btnColorW btnTypeR" style="width:200px;"><span>ì·¨ì†Œ</span></a>
						<a href="#" class="btn btnSizeL btnArr btnColorB btnTypeR" style="width:200px;"><span>ìˆ˜ì •</span></a>
					</div>
	            </div>
	        </div>
	    </div>
	</div>
	<!-- ë©”ì¸ë¡¤ë§ ì‚­ì œ -->
	<div id="mainDel" class="lyPopArea">
	    <div class="lyPop">
	        <div class="lyWrap">
	            <button type="button" class="lyClose" onclick="layerPopClose();"><span class="hide">CLOSED</span></button>
	            <div class="lyTit">ë©”ì¸ ë¡¤ë§ ì‚­ì œ</div>
	            <div class="lyBody basic">
	                <p>ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
	                <div class="btn_wrap length2">
	                    <a href="javascript:void(0);" onclick="layerPopClose();" class="btn btnSizeL btnArr btnColorW btnTypeR"><span>ì·¨ì†Œ</span></a>
	                    <a href="javascript:void(0);" onclick="layerPopClose();" class="btn btnSizeL btnArr btnColorB btnTypeR"><span>í™•ì¸</span></a>
	                </div>
	            </div>
	        </div>
	    </div>
	</div>
</body>
</html>
<script>
	//íŒŒì¼ ë“±ë¡	
	var fileBuffer = []; 	// ì´ë¯¸ì§€ ì €ì¥ë°°ì—´
	var fileCnt = 0;	// ì´ë¯¸ì§€ ê°œìˆ˜
	
	$(document).off('change','#enrollMain #imgUpload').on('change','#enrollMain #imgUpload',function(){		
		const target = $(this);
		var targetFilesCnt = target[0].files.length;
		
		//ìœ íš¨ì„± ê²€ì‚¬
		if(fileBuffer.length >= 1){
			alert("ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 1ê°œê¹Œì§€ ì²¨ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
			return;
		}else if(targetFilesCnt + fileBuffer.length > 1){
			alert("ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 1ê°œê¹Œì§€ ì²¨ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
			return;
		}else if(fileCnt + targetFilesCnt > 1){ //ê¸°ì¡´ì´ë¯¸ì§€ì™€ ì‹ ê·œì´ë¯¸ì§€ ê°œìˆ˜ì˜ í•©
			alert("ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 1ê°œê¹Œì§€ ì²¨ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
			return;
		}			
		
		var validateChk = true;		
		//ìœ íš¨ì„± ê²€ì‚¬
		$.each(target[0].files,function(index,file){
			const fileName = file.name;
			var fileNameExtensionIndex = fileName.lastIndexOf('.') + 1;
		    var fileNameExtension = fileName.toLowerCase().substring(fileNameExtensionIndex, fileName.length);
		    if (!((fileNameExtension === 'jpg') || (fileNameExtension === 'gif') || (fileNameExtension === 'png') || (fileNameExtension === 'jpeg'))){
		    	alert("ìƒí’ˆ ì´ë¯¸ì§€ëŠ” ì´ë¯¸ì§€ íŒŒì¼(gif,jpg,jpeg,png)ë§Œ ë“±ë¡ ê°€ëŠ¥í•©ë‹ˆë‹¤");
		    	validateChk = false;
		    	return;
		    }
		    
		    if(file.size > 1024 * 1024 * 5){
		    	alert("ì‚¬ì§„ì€ ìµœëŒ€ 5mbë¯¸ë§Œìœ¼ë¡œ ì²¨ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
		    	validateChk = false;
		    	return;
		    }
		});
		
		if(!validateChk)return false;
		
		//filebuffer ì €ì¥
		Array.prototype.push.apply(fileBuffer, target[0].files);
		
		var html = '';
		$.each(target[0].files,function(index,file){
			
			//ë¯¸ë¦¬ë³´ê¸°
			var reader = new FileReader();
			var fileUrl;
			reader.onload = function(e) {
					const fileName = file.name;
					html+= '<li class="imgCutting">';
					html+= '<div class="imgBox">';
					html+= '	<img src="'+e.target.result+'" alt="">';
					html+= '</div>';
					html+= '<a href="javascript:void(0)" class="closeLink"><span class="hide">close</span></a>';
					html+= '</li>';
					$('.fileUploadArea').append(html);
					//ì´ë¯¸ì§€ ë§ì¶”ê¸°
					imgCrop();
					html = "";
			};
			
			reader.readAsDataURL(file);
			
			fileCnt++;
		});
	});
	
	//íŒŒì¼ì‚­ì œ
	$(document).off("click","#enrollMain .imgCutting .closeLink").on('click','#enrollMain .imgCutting .closeLink',function(){
		var imgno = $(this).parent("li").find("#reviewImgNo").val();
		const fileIndex = $(this).parent("li").index();
		
		fileCnt--;//íŒŒì¼ê°œìˆ˜ ê°ì†Œ
		
		if(imgno){//ê¸°ì¡´ë“±ë¡ëœ ì´ë¯¸ì§€ë©´ delimgnoì—ë§Œ push
			delimgno.push(imgno);
		}else{//ì‹ ê·œ ë“±ë¡ëœ ì´ë¯¸ì§€ë©´ fileBufferì—ì„œ ì œê±°
			fileBuffer.splice(fileIndex-1,1);
		}
		
		$('.fileUploadArea > li:eq('+fileIndex+')').remove();
	});
</script>
